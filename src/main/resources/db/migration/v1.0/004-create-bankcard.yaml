databaseChangeLog:
  - changeSet:
      id: 160525-01-create-bank-card
      author: Crystal
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: bank_card_pkey
                  autoIncrement: true
              - column: { name: user_id, type: BIGINT }
              - column:
                  name: pan
                  type: VARCHAR(16)
                  constraints:
                    unique: true
                    uniqueConstraintName: uq_bank_pan
              - column:
                  name: balance
                  type: NUMERIC(38, 2)
              - column: { name: expiry_date, type: date }
              - column: { name: status_id, type: INTEGER }
            tableName: bank_cards
  - changeSet:
      id: 160525-02-bankcard_status_id_fkey
      author: Crystal
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: status_id
            baseTableName: bank_cards
            constraintName: bankcard_status_id_fkey
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: id
            referencedTableName: card_statuses
            validate: true
  - changeSet:
      id: 160525-007-bankcard_user_id_fkey
      author: Crystal
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: user_id
            baseTableName: bank_cards
            constraintName: bank_card_user_id_fkey
            deferrable: false
            initiallyDeferred: false
            onDelete: SET NULL
            onUpdate: NO ACTION
            referencedColumnNames: id
            referencedTableName: users
            validate: true